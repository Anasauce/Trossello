#!/usr/bin/env node

const childProcess = require('child_process');

const watch = process.argv[2] === '-w'

const spawn = (cmd, args, watchArgs) => {
  if (watch) args = args.concat(watchArgs)
  childProcess.spawn(cmd, args, {stdio: 'inherit'})
}

spawn('./node_modules/.bin/webpack', [], ['--watch']);
spawn('./node_modules/.bin/babel', ['./server', '--out-dir', './build/server'], ['--watch', './server']);

if (process.env.NODE_ENV === 'development'){
  spawn('./node_modules/.bin/babel', ['./test', '--out-dir', './build/test'], ['--watch', './test']);
}
